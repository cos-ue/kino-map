/**
 * RWD reflow table switch for mobile UI/UX by collapsing columns
 *
 * @author  Nick Tsai <myintaer@gmail.com>
 * @version 1.0.0
 * @see     https://github.com/yidas/jquery-reflow-table
 */
(function($,window){"use strict";var count=0;var ReflowTable=function(element,options){this.$table=$(element).first();this.options=options||{};this.namespace;this.thead;this.autoWidth;this.widthRatio;this.widthSize;this.className="reflow-table";this.mobileModeClassName="reflow-table-mobile-mode";this.titleAttr="data-th";this.widthRatioClassName;this.widthWidthClassName;this.eventMobileOn="reflow-table.mobile.on";this.eventMobileOff="reflow-table.mobile.off";this.init();return this};ReflowTable.prototype.init=function(){var getNamespace=function(){var ns;var options=this.$table.data(this.className)||{};ns=options.namespace||null;ns=ns||this.$table.attr("id");if(!ns){count+=1;ns=this.className+"-"+count}return ns}.bind(this);var setOptions=function(){var options=this.options;this.namespace=this.options.namespace||getNamespace();this.thead=this.options.thead||this.$table.find("thead");this.autoWidth=typeof options.autoWidth!=="undefined"?options.autoWidth:736;this.widthRatio=typeof options.widthRatio!=="undefined"?options.widthRatio:"50";this.widthSize=typeof options.widthSize!=="undefined"?options.widthSize:false;this.widthRatioClassName=this.className+"-w-"+this.widthRatio;this.widthWidthClassName=this.className+"-"+this.widthSize;this.$table.data(this.className,this.options)}.bind(this);var restoreOptions=function(){this.options=this.$table.data(this.className)||{};setOptions();return this.options}.bind(this);if(!this.$table.length)throw"No element selected";if(!this.$table.is("table"))throw"The element must be a table dom";if(this.options==="update"){restoreOptions();return this.update()}setOptions();this.destroy();this.build();if(typeof this.options.eventMobileOn==="function"){this.$table.on(this.eventMobileOn,this.options.eventMobileOn)}if(typeof this.options.eventMobileOff==="function"){this.$table.on(this.eventMobileOff,this.options.eventMobileOff)}this.$table.addClass(this.className);if(this.widthRatio){this.$table.addClass(this.widthRatioClassName)}if(this.widthSize){this.$table.addClass(this.widthWidthClassName)}if(this.autoWidth){var that=this;$(window).on("resize."+that.namespace,function(){if($(window).width()<=that.autoWidth){that.mobileMode(true)}else{that.mobileMode(false)}});$(window).trigger("resize."+this.namespace)}};ReflowTable.prototype.build=function(){var $table=this.$table;var titleAttr=this.titleAttr;$(this.thead).find("th").each(function(key,thRow){$table.find("tbody tr td:nth-child("+(key+1)+")").attr(titleAttr,$(thRow).text())});return this};ReflowTable.prototype.mobileMode=function(enable){enable=typeof enable!=="undefined"?enable:true;var isMobileMode=this.isMobileMode();if(enable){this.$table.addClass(this.mobileModeClassName);if(!isMobileMode)this.$table.trigger($.Event(this.eventMobileOn))}else{this.$table.removeClass(this.mobileModeClassName);if(isMobileMode)this.$table.trigger($.Event(this.eventMobileOff))}return this};ReflowTable.prototype.switchMode=function(){if(this.isMobileMode())this.mobileMode(false);else this.mobileMode(true);return this};ReflowTable.prototype.isMobileMode=function(){return this.$table.hasClass(this.mobileModeClassName)?true:false};ReflowTable.prototype.update=function(){this.build();return this};ReflowTable.prototype.unbind=function(){$(window).off("resize."+this.namespace);this.$table.off();return this};ReflowTable.prototype.destroy=function(){this.unbind();this.mobileMode(false);this.$table.removeClass(this.className);if(this.widthRatio){this.$table.removeClass(this.widthRatioClassName)}if(this.widthSize){this.$table.removeClass(this.widthWidthClassName)}};window.ReflowTable=ReflowTable;$.fn.reflowTable=function(options){if(this.length===1){return new ReflowTable(this,options)}else if(this.length>1){var result=[];this.each(function(){result.push(new ReflowTable(this,options))});return result}return false}})(jQuery,window);